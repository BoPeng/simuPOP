plot(avg)
help(for)
 avg[,2:]
  
means
q()
n
q()
y
analyze <- function(sce)
{
  fst = as.matrix(read.table(paste('sce',sce,'_Fst.txt', sep='')))

  # get dimension, 0,100,...,10000 gen; 100 * 6
  dim(fst)

  nCol = 6
  nRep = dim(fst)[2]/nCol

  # get single (locus2)
  avg = fst[, c(1, seq(3,nRep*6, by=6))]

  mm = max(avg[,c(2,3,4,5)])
  
  postscript(paste('OneLocus', sce, '.eps', sep=''))
  par(mfrow=c(2,1))
  plot( avg[,1], avg[,2], ylim=c(0,mm),type='l', xlab='generation', ylab='Fst')
    grid(10,10)
  title( paste('Four replicates:',  scenarios[sce+1]))
  for( i in 1:3){
    lines( avg[,1], avg[,2+i])
  }

  # get mean and stdev and 95% quantile
  quan = apply( avg[,-1], 1, function(x){
    return( c(quantile(x,.75), quantile(x,.5),quantile(x,.25),
                  mean(x), sqrt(var(x))))
    })
  plot( avg[,1], quan[1,],ylim=c(0,mm), type='l', lty=3, xlab='generation', ylab='Fst')
    grid(10,10)
  title( paste('Mean/Median Fst:',  scenarios[sce+1]))
  lines( avg[,1], quan[2,], type='l', lty=1)
  lines( avg[,1], quan[3,], type='l', lty=3)
  lines( avg[,1], quan[4,], type='l', lty=1,lwd=2)

  ret = quan[c(4,5),dim(fst)[1]]
  dev.off()
  
  # get summaries. (12 loci)
  avg = fst[, c(1, seq(6,nRep*6, by=6))]
  
  
  postscript(paste('AllLoci', sce, '.eps', sep=''))
  par(mfrow=c(2,1))
  plot( avg[,1], avg[,2], ylim=c(0,mm),type='l', xlab='generation', ylab='Fst')
    grid(10,10)
  title( paste('Four replicates:',  scenarios[sce+1]))
  for( i in 1:3){
    lines( avg[,1], avg[,2+i])
  }

  # get mean and stdev and 95% quantile
  quan = apply( avg[,-1], 1, function(x){
    return( c(quantile(x,.75), quantile(x,.5),quantile(x,.25),
                  mean(x), sqrt(var(x))))
    })
  plot( avg[,1], quan[1,],ylim=c(0,mm), type='l', lty=3, xlab='generation', ylab='Fst')
  title( paste('Mean/Median Fst:',  scenarios[sce+1]))
  grid(10,10)
  lines( avg[,1], quan[2,], type='l', lty=1)
  lines( avg[,1], quan[3,], type='l', lty=3)
  lines( avg[,1], quan[4,], type='l', lty=1,lwd=2)
  
  dev.off()
  return(cbind(ret, quan[c(4,5),dim(fst)[1]]))
}
list(a=1,b=2)
b=a#mean
b=a$mean
b
plot(b)
mean(b[140:157])
mean(b[150:157])
mean(b[120:137])
mean(b[100:120])
mean(b[120:140])
mean(b[140:157])
a
b
plot(b)
a$mean
plot(a$mean)
plot(b)
plot(a$mean)
plot(a$mean, type='l')
plot(b, type='l')
q()
n
