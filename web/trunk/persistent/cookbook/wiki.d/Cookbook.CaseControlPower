version=pmwiki-2.2.0 ordered=1 urlencoded=1
agent=Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.7) Gecko/20100713 Firefox/3.6.7 (.NET CLR 3.5.30729)
author=
charset=ISO-8859-1
csum=
ctime=1261000329
host=127.0.0.1
name=Cookbook.CaseControlPower
rev=14
targets=
text=(:title A power calculator for case control association studies of samples with  known family histories:)%0a%0a%0a%25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:caseControlPower.py | http://simupop.sourceforge.net/images/download.jpg]]|caseControlPower.py%0a%0a!!! Introduction%0aThis program is a power calculator for case-control association studies. Compared%0ato other power calculators, this program is unique in that it assumes that we%0aknow the family history of cases and/or controls. Because cases with known family%0ahistory have higher probability of carrying a disease predisposing loci, such%0astudy design is more powerful than regular case control association studies.%0a%0aPlease cite the following paper if you have used this script for your analysis:%0a%0a->'''Power analysis for case–control association studies of samples with known family histories'''%0a->Bo Peng, Biao Li, Younghun Han and Christopher I. Amos%0a->LINK: http://www.springerlink.com/content/y85k314765524153/%0a%0a!!! Installation%0a%0aBecause this script is written in Python and uses simuPOP for its graphical user interface, you will need to install Python (2.4 or higher, but not Python 3) and [[http://simupop.sf.net | simuPOP]] in order to use it. More specifically, you need to %0a%0a* Install Python if it is not available.%0a* Download and install simuPOP following the installation instruction [[http://simupop.sourceforge.net/Main/Download | here]].%0a* Download caseControlPower.py from this page and save it to a directory.%0a* Open a """command window""", go to the directory with caseControlPower.py, type%0a-->@@> caseControlPower.py@@%0a->to start a graphical user interface, or use%0a-->@@> caseControlPower.py --gui=False@@%0a->to use interactive user input. You can use%0a-->@@> caseControlPower.py --help@@%0a->to check allowed command line options. You can also import this script as a module in another script and use the functions directly.%0a%0aPlease feel free to [[mailto:bpeng@mdanderson.org | email me]] if you have any question about this script.%0a%0a!!! How to use this script%0aOur analysis assumes a disease predisposing locus and a marker locus that are%0aboth in Hardy Weinberg Equilibrium. To calculate the power to detect a %0aparticular disease, you will need to disease mode (addition, recessive etc),%0aprevalence, disease allele frequency, marker allele frequency, linkage%0adisequilibrium between two loci (default to complete linkage), types of%0acases and controls, genotype relative risk and significance level.%0a%0aAttach:caseControlPower.png%0a%0aCases and controls should be specified as a dictionary of cases or controls with%0adifferent types. The pedigree types are  presented as a string of affection status%0aof father, mother, proband, and optional siblings of the proband. The affection%0astatus is specified as 'A' for affected, 'U' for unaffected', and '*' for unknown.%0aFor example, to calculate the power of two mixing pedigree types, you can use %0a  cases = "{'**A': 100, '**AA': 200}"%0awhich has 100 regular cases and 200 cases with an affected sibling. Of course, %0aregular controls has the third letter as 'U'.%0a%0aThis script can carry out the following functions:%0a%0a* '''Calculate power''':%0a->Given the number of cases of each pedigree type and genotype relative risk, calculate statistical power. You should specify number of cases and controls.%0a%0a* '''Calculate minimal detectable relative risk'''%0a->Given number of cases and controls and power, calculate minimal detectable relative risk.%0a%0a* '''Calculate needed samples from ratio between controls / cases'''%0a->Given power and relative risk, calculate number of cases and controls from a ratio.%0a%0a* '''Calculate needed cased from fixed controls.'''%0a->Given power and relative risk, calculate number of cases and controls from a fixed number of controls.%0a%0a* '''Calculate needed cased from fixed cases.'''%0a->Given power and relative risk, calculate number of cases and controls from a fixed number of cases.%0a%0aThis script accepts a large number of parameters and some of them are%0ahidden in the sense that they are not accessible from the graphical user%0ainterface. Please refer the description of each parameter for details.%0a%0aIn addition to command line (you can use --gui=False to use this script in batch%0amode) and a graphical user interface, you can also import this script and use %0athe functions directly from another script. This will allow you to run a large%0anumber of analyses easily and use a logging object to dump important internal%0asteps. Please refer to script [[Attach:PowerAnalysis.py | PowerAnalysis.py]] for an example. That script%0aloads caseControlPower.py and performs all calculates for Peng et al, 2010.%0a%0a!!! Reference to command line parameters%0a%0aThis program is a power calculator for case-control association studies. Compared%0ato other power calculators, this program is unique in that it assumes that we%0aknow the family history of cases and/or contorls so although only samples are%0agenotyped and used for statistical analysis, this study design has higher power%0athan regular case control studies because the probands have higher probability%0ato have disease alleles at the disease causing locus.%0a%0aCases and controls should be specified as a dictionary of cases or controls with%0adifferent types. The pedigree types are  presented as a string of affection status%0aof father, mother, proband, and optional siblings of the proband. The affection%0astatus is specified as 'A' for affected, 'U' for unaffected', and '*' for unknown.%0aFor example, to calculate the power of two mixing pedigree types, you can use %0a  cases = "{'**A': 100, '**AA': 200}"%0awhich has 100 regular cases and 200 cases with an affected sibling. Of course, %0aregular controls has the third letter as 'U'.%0a%0aThis script can carry out the following functions:%0a%0a1. Power calculation:%0aGiven the number of cases of each pedigree type and genotype relative risk,%0acalculate statistical power. You should specify number of cases and controls.%0a%0a2. Calculate minimal detectable relative risk.%0aGiven number of cases and controls and power, calculate minimal detectable%0arelative risk. %0a%0a3. Calculate needed samples from ratio between ctrols / cases%0aGiven power and relative risk, calculate number of cases and controls from %0aa ratio.%0a%0a4. Calculate needed cased from fixed controls.%0aGiven power and relative risk, calculate number of cases and controls from %0aa fixed number of controls.%0a%0a4. Calculate needed cased from fixed cases.%0aGiven power and relative risk, calculate number of cases and controls from %0aa fixed number of cases.%0a%0aThis program allows the users to variate the following passed-in parameters:%0a%0aK: Disease prevalence%0ap: Disease allele frequency%0ax: Marker allele frequency%0aLD: LD(D')%0aalpha: Significant level%0apower: Power%0aGrr: Genotype relative risk%0a%0aso analyses on multiple disease models can be performed all at once.%0a%0a%0ausage: caseControlPower.py [-opt [arg] | --opt [=arg]] ...%0a%0aoptions:%0a  -h, --help%0a        Show this help message and exit.%0a%0a  --config=ARG (default: None)%0a        Load parameters from file ARG.%0a%0a  --optimized%0a        Run the script using an optimized simuPOP module.%0a%0a  --gui=[None|True|False|Tkinter|wxPython] (default: None)%0a        Which graphical toolkit to use.%0a%0a  --mode=ARG  (default: 'Additive')%0a        Disease models with different relationship between risks of AA, AB and%0a        BB, and different definitions of genotype relative risk. Let A be the%0a        disease allele, and r_AA, r_AB and r_BB be the penetrance of genotypes%0a        AA, AB and BB respectively, six disease types are provided for this%0a        analysis. Additive_AA and LogAdditive are alternatives of types Additive%0a        and Multiplicative by using alternative definitions of genotype relative%0a        risks.%0a          Dominant:  r_AB=r_AA, Grr = r_AA / r_BB%0a          Recessive: r_AB=r_BB, Grr = r_AA / r_BB%0a          Multiplicative: r_AB=sqrt(r_AA * r_BB), Grr = r_AB / r_BB%0a          Additive:  r_AB=(r_AA + r_BB)/2, Grr = r_AB / r_BB%0a          Additive_AA: r_AB=(r_AA + r_BB)/2, Grr = r_AA / r_BB%0a          LogAdditive: r_AB=sqrt(r_AA * r_BB), Grr = r_AA / r_BB%0a%0a  --K=ARG  (default: [0.050000000000000003])%0a        Disease prevalence%0a%0a  --p=ARG  (default: [0.14999999999999999])%0a        Disease allele frequency%0a%0a  --x=ARG  (default: [0])%0a        Marker allele frequency. If LD is 1, this parameter is ignored because%0a        it will be assumed to be the same as disease allele frequency.%0a%0a  --genoP=ARG  (default: [0])%0a        This option is hidden. If specified, it overrides parameter p and%0a        specifies the frequency of causal genotypes so that%0a          p=sqrt(genoP) for a recessive model (frequency of AA).%0a          p=1-sqrt(1-genoP) for other models (frequency of AA + AB)%0a%0a  --genoX=ARG  (default: [0])%0a        This option is hidden. If specified, it overrides paramter x and%0a        specifies the frequency of causal genotypes at the marker locus so that%0a          p=sqrt(genoX) for a recessive model (frequency of AA).%0a          p=1-sqrt(1-genoX) for other models (frequency of AA + AB)%0a%0a  --Dprime=ARG  (default: 1)%0a        Linkage disequilibrium (D') between marker locus and disease locus. Only%0a        one of parameters Dprime and R2 should be specified.%0a%0a  --R2=ARG  (default: 1)%0a        Linkage disequilibrium (R2) between marker locus and disease locus. Only%0a        one of the parameters Dprime and R2 should be specified.%0a%0a  --analysis=ARG  (default: 'Statistical power')%0a        Perform different types of calculations, each require the specification%0a        of different parameters. More specifically,%0a        Statistical power: fix number of cases and controls, alpha, Grr,%0a        calculate power. Ignore ratio.%0a        Minimal detectable relative risk: fix number of cases and controls,%0a        alpha, power, calculate Grr. Ignore ratio.%0a        Sample size from #ctrl/#case: number of cases and controls treats as%0a        weights, fix ratio, alpha, Grr, power, calculate sample size.%0a        Sample size from fixed #ctrl: Fix number of controls, alpha, Grr, power%0a        and calculate number of cases. Ignore ratio. Numbers of different types%0a        of cases are treated as weights.%0a        Sample size from fixed #cases: Fix number of cases, alpha, Grr, power%0a        and calculate number of controls. Ignore ratio. Number of different%0a        types of controls are treated as weights.%0a%0a  --cases=ARG  (default: {'**A': 1000})%0a        Type and number of cases. The count will be considered as weight in%0a        'sample size from #ctrl/#case', and 'sample size from fixed #ctrl'%0a        analysis%0a%0a  --controls=ARG  (default: {'**U': 1000})%0a        Type and number of controls. The count will be considered as weight in%0a        'Sample size from #ctrl/#case'.%0a%0a  --ratio=ARG  (default: 1)%0a        Ratio, use for calculate sample size from #ctrl/#case%0a%0a  --alpha=ARG  (default: [9.9999999999999995e-08])%0a        Significant level%0a%0a  --power=ARG  (default: [0.80000000000000004])%0a        Power of a case-control assocition test if number cases and relative%0a        risk are specified%0a%0a  --Grr=ARG  (default: [1.2])%0a        Relative genotype risk for a disease model. The exact definition of this%0a        quantity depends on the disease model.%0a%0a%0a
time=1280160597
title=A power calculator for case control association studies of samples with  known family histories
author:1280160597=
diff:1280160597:1280160457:=43,44d42%0a%3c %0a%3c Attach:caseControlPower.png%0a
host:1280160597=127.0.0.1
author:1280160457=
diff:1280160457:1272376712:=83,133d82%0a%3c This program is a power calculator for case-control association studies. Compared%0a%3c to other power calculators, this program is unique in that it assumes that we%0a%3c know the family history of cases and/or contorls so although only samples are%0a%3c genotyped and used for statistical analysis, this study design has higher power%0a%3c than regular case control studies because the probands have higher probability%0a%3c to have disease alleles at the disease causing locus.%0a%3c %0a%3c Cases and controls should be specified as a dictionary of cases or controls with%0a%3c different types. The pedigree types are  presented as a string of affection status%0a%3c of father, mother, proband, and optional siblings of the proband. The affection%0a%3c status is specified as 'A' for affected, 'U' for unaffected', and '*' for unknown.%0a%3c For example, to calculate the power of two mixing pedigree types, you can use %0a%3c   cases = "{'**A': 100, '**AA': 200}"%0a%3c which has 100 regular cases and 200 cases with an affected sibling. Of course, %0a%3c regular controls has the third letter as 'U'.%0a%3c %0a%3c This script can carry out the following functions:%0a%3c %0a%3c 1. Power calculation:%0a%3c Given the number of cases of each pedigree type and genotype relative risk,%0a%3c calculate statistical power. You should specify number of cases and controls.%0a%3c %0a%3c 2. Calculate minimal detectable relative risk.%0a%3c Given number of cases and controls and power, calculate minimal detectable%0a%3c relative risk. %0a%3c %0a%3c 3. Calculate needed samples from ratio between ctrols / cases%0a%3c Given power and relative risk, calculate number of cases and controls from %0a%3c a ratio.%0a%3c %0a%3c 4. Calculate needed cased from fixed controls.%0a%3c Given power and relative risk, calculate number of cases and controls from %0a%3c a fixed number of controls.%0a%3c %0a%3c 4. Calculate needed cased from fixed cases.%0a%3c Given power and relative risk, calculate number of cases and controls from %0a%3c a fixed number of cases.%0a%3c %0a%3c This program allows the users to variate the following passed-in parameters:%0a%3c %0a%3c K: Disease prevalence%0a%3c p: Disease allele frequency%0a%3c x: Marker allele frequency%0a%3c LD: LD(D')%0a%3c alpha: Significant level%0a%3c power: Power%0a%3c Grr: Genotype relative risk%0a%3c %0a%3c so analyses on multiple disease models can be performed all at once.%0a%3c %0a%3c %0a137,233c86,170%0a%3c   -h, --help%0a%3c         Show this help message and exit.%0a%3c %0a%3c   --config=ARG (default: None)%0a%3c         Load parameters from file ARG.%0a%3c %0a%3c   --optimized%0a%3c         Run the script using an optimized simuPOP module.%0a%3c %0a%3c   --gui=[None|True|False|Tkinter|wxPython] (default: None)%0a%3c         Which graphical toolkit to use.%0a%3c %0a%3c   --mode=ARG  (default: 'Additive')%0a%3c         Disease models with different relationship between risks of AA, AB and%0a%3c         BB, and different definitions of genotype relative risk. Let A be the%0a%3c         disease allele, and r_AA, r_AB and r_BB be the penetrance of genotypes%0a%3c         AA, AB and BB respectively, six disease types are provided for this%0a%3c         analysis. Additive_AA and LogAdditive are alternatives of types Additive%0a%3c         and Multiplicative by using alternative definitions of genotype relative%0a%3c         risks.%0a%3c           Dominant:  r_AB=r_AA, Grr = r_AA / r_BB%0a%3c           Recessive: r_AB=r_BB, Grr = r_AA / r_BB%0a%3c           Multiplicative: r_AB=sqrt(r_AA * r_BB), Grr = r_AB / r_BB%0a%3c           Additive:  r_AB=(r_AA + r_BB)/2, Grr = r_AB / r_BB%0a%3c           Additive_AA: r_AB=(r_AA + r_BB)/2, Grr = r_AA / r_BB%0a%3c           LogAdditive: r_AB=sqrt(r_AA * r_BB), Grr = r_AA / r_BB%0a%3c %0a%3c   --K=ARG  (default: [0.050000000000000003])%0a%3c         Disease prevalence%0a%3c %0a%3c   --p=ARG  (default: [0.14999999999999999])%0a%3c         Disease allele frequency%0a%3c %0a%3c   --x=ARG  (default: [0])%0a%3c         Marker allele frequency. If LD is 1, this parameter is ignored because%0a%3c         it will be assumed to be the same as disease allele frequency.%0a%3c %0a%3c   --genoP=ARG  (default: [0])%0a%3c         This option is hidden. If specified, it overrides parameter p and%0a%3c         specifies the frequency of causal genotypes so that%0a%3c           p=sqrt(genoP) for a recessive model (frequency of AA).%0a%3c           p=1-sqrt(1-genoP) for other models (frequency of AA + AB)%0a%3c %0a%3c   --genoX=ARG  (default: [0])%0a%3c         This option is hidden. If specified, it overrides paramter x and%0a%3c         specifies the frequency of causal genotypes at the marker locus so that%0a%3c           p=sqrt(genoX) for a recessive model (frequency of AA).%0a%3c           p=1-sqrt(1-genoX) for other models (frequency of AA + AB)%0a%3c %0a%3c   --Dprime=ARG  (default: 1)%0a%3c         Linkage disequilibrium (D') between marker locus and disease locus. Only%0a%3c         one of parameters Dprime and R2 should be specified.%0a%3c %0a%3c   --R2=ARG  (default: 1)%0a%3c         Linkage disequilibrium (R2) between marker locus and disease locus. Only%0a%3c         one of the parameters Dprime and R2 should be specified.%0a%3c %0a%3c   --analysis=ARG  (default: 'Statistical power')%0a%3c         Perform different types of calculations, each require the specification%0a%3c         of different parameters. More specifically,%0a%3c         Statistical power: fix number of cases and controls, alpha, Grr,%0a%3c         calculate power. Ignore ratio.%0a%3c         Minimal detectable relative risk: fix number of cases and controls,%0a%3c         alpha, power, calculate Grr. Ignore ratio.%0a%3c         Sample size from #ctrl/#case: number of cases and controls treats as%0a%3c         weights, fix ratio, alpha, Grr, power, calculate sample size.%0a%3c         Sample size from fixed #ctrl: Fix number of controls, alpha, Grr, power%0a%3c         and calculate number of cases. Ignore ratio. Numbers of different types%0a%3c         of cases are treated as weights.%0a%3c         Sample size from fixed #cases: Fix number of cases, alpha, Grr, power%0a%3c         and calculate number of controls. Ignore ratio. Number of different%0a%3c         types of controls are treated as weights.%0a%3c %0a%3c   --cases=ARG  (default: {'**A': 1000})%0a%3c         Type and number of cases. The count will be considered as weight in%0a%3c         'sample size from #ctrl/#case', and 'sample size from fixed #ctrl'%0a%3c         analysis%0a%3c %0a%3c   --controls=ARG  (default: {'**U': 1000})%0a%3c         Type and number of controls. The count will be considered as weight in%0a%3c         'Sample size from #ctrl/#case'.%0a%3c %0a%3c   --ratio=ARG  (default: 1)%0a%3c         Ratio, use for calculate sample size from #ctrl/#case%0a%3c %0a%3c   --alpha=ARG  (default: [9.9999999999999995e-08])%0a%3c         Significant level%0a%3c %0a%3c   --power=ARG  (default: [0.80000000000000004])%0a%3c         Power of a case-control assocition test if number cases and relative%0a%3c         risk are specified%0a%3c %0a%3c   --Grr=ARG  (default: [1.2])%0a%3c         Relative genotype risk for a disease model. The exact definition of this%0a%3c         quantity depends on the disease model.%0a%3c %0a%3c %0a---%0a>   -h, --help            show this help message and exit%0a>   --config ARG          load parameters from ARG%0a>   --optimized           run the script using an optimized simuPOP module%0a>   --gui ARG             which graphical toolkit to use%0a>   --mode ARG            Mode of inheritance [default: Additive ]%0a>                         Disease models with different relationship between risks%0a>                         of AA, AB and BB, and different definitions of genotype%0a>                         relative risk. Let A be the disease allele, and r_AA,%0a>                         r_AB and r_BB be the penetrance of genotypes AA, AB and%0a>                         BB respectively, six disease types are provided for this%0a>                         analysis. Additive_AA and LogAdditive are alternatives%0a>                         of types Additive and Multiplicative by using%0a>                         alternative definitions of genotype relative risks.%0a>                           Dominant:  r_AB=r_AA, Grr = r_AA / r_BB%0a>                           Recessive: r_AB=r_BB, Grr = r_AA / r_BB%0a>                           Multiplicative: r_AB=sqrt(r_AA * r_BB), Grr = r_AB /%0a>                         r_BB%0a>                           Additive:  r_AB=(r_AA + r_BB)/2, Grr = r_AB / r_BB%0a>                           Additive_AA: r_AB=(r_AA + r_BB)/2, Grr = r_AA / r_BB%0a>                           LogAdditive: r_AB=sqrt(r_AA * r_BB), Grr = r_AA / r_BB%0a>   --K ARG               Disease prevalence [default: 0.05 ]%0a>   --p ARG               Disease allele frequency [default: 0.15 ]%0a>   --x ARG               Marker allele frequency [default: 0 ]%0a>                         Marker allele frequency. If LD is 1, this parameter is%0a>                         ignored because it will be assumed to be the same as%0a>                         disease allele frequency.%0a>   --genoP ARG           [default: 0 ]%0a>                         This option is hidden. If specified, it overrides%0a>                         parameter p and specifies the frequency of causal%0a>                         genotypes so that%0a>                           p=sqrt(genoP) for a recessive model (frequency of AA).%0a>                           p=1-sqrt(1-genoP) for other models (frequency of AA +%0a>                         AB)%0a>   --genoX ARG           [default: 0 ]%0a>                         This option is hidden. If specified, it overrides%0a>                         paramter x and specifies the frequency of causal%0a>                         genotypes at the marker locus so that%0a>                           p=sqrt(genoX) for a recessive model (frequency of AA).%0a>                           p=1-sqrt(1-genoX) for other models (frequency of AA +%0a>                         AB)%0a>   --Dprime ARG          LD (D') [default: 1 ]%0a>                         Linkage disequilibrium (D') between marker locus and%0a>                         disease locus. Only one of parameters Dprime and R2%0a>                         should be specified.%0a>   --R2 ARG              LD (R2) [default: 1 ]%0a>                         Linkage disequilibrium (R2) between marker locus and%0a>                         disease locus. Only one of the parameters Dprime and R2%0a>                         should be specified.%0a>   --analysis ARG        Type of analysis [default: Statistical power ]%0a>                         Perform different types of calculations, each require%0a>                         the specification of different parameters. More%0a>                         specifically,%0a>                         Statistical power: fix number of cases and controls,%0a>                         alpha, Grr, calculate power. Ignore ratio.%0a>                         Minimal detectable relative risk: fix number of cases%0a>                         and controls, alpha, power, calculate Grr. Ignore ratio.%0a>                         Sample size from #ctrl/#case: number of cases and%0a>                         controls treats as weights, fix ratio, alpha, Grr,%0a>                         power, calculate sample size.%0a>                         Sample size from fixed #ctrl: Fix number of controls,%0a>                         alpha, Grr, power and calculate number of cases. Ignore%0a>                         ratio. Numbers of different types of cases are treated%0a>                         as weights.%0a>                         Sample size from fixed #cases: Fix number of cases,%0a>                         alpha, Grr, power and calculate number of controls.%0a>                         Ignore ratio. Number of different types of controls are%0a>                         treated as weights.%0a>   --cases ARG           #cases [default: {'**A': 1000} ]%0a>                         Type and number of cases. The counts will be considered%0a>                         as weights in 'sample size from #ctrl/#case', and%0a>                         'sample size from fixed #ctrl' analysis%0a>   --controls ARG        #controls [default: {'**U': 1000} ]%0a>                         Type and number of controls. The counts will be%0a>                         considered as weights in 'Sample size from #ctrl/#case'.%0a>   --ratio ARG           #controls / #cases for analysis 3 [default: 1 ]%0a>                         Ratio, use for calculate sample size from the ratio of%0a>                         #ctrl to #case%0a>   --alpha ARG           Significant level [default: 1e-07 ]%0a>   --power ARG           Power [default: 0.8 ]%0a>                         Power of a case-control assocition test if number cases%0a>                         and relative risk are specified%0a>   --Grr ARG             Genotype Relative risk [default: 1.2 ]%0a>                         Relative genotype risk for a disease model. The exact%0a>                         definition of this quantity depends on the disease%0a>                         model.%0a
host:1280160457=127.0.0.1
author:1272376712=
diff:1272376712:1272376599:=33,34d32%0a%3c %0a%3c Please feel free to [[mailto:bpeng@mdanderson.org | email me]] if you have any question about this script.%0a
host:1272376712=127.0.0.1
author:1272376599=
diff:1272376599:1272376486:=53,66c53,71%0a%3c * '''Calculate power''':%0a%3c ->Given the number of cases of each pedigree type and genotype relative risk, calculate statistical power. You should specify number of cases and controls.%0a%3c %0a%3c * '''Calculate minimal detectable relative risk'''%0a%3c ->Given number of cases and controls and power, calculate minimal detectable relative risk.%0a%3c %0a%3c * '''Calculate needed samples from ratio between controls / cases'''%0a%3c ->Given power and relative risk, calculate number of cases and controls from a ratio.%0a%3c %0a%3c * '''Calculate needed cased from fixed controls.'''%0a%3c ->Given power and relative risk, calculate number of cases and controls from a fixed number of controls.%0a%3c %0a%3c * '''Calculate needed cased from fixed cases.'''%0a%3c ->Given power and relative risk, calculate number of cases and controls from a fixed number of cases.%0a---%0a> # Calculate power:%0a> Given the number of cases of each pedigree type and genotype relative risk,%0a> calculate statistical power. You should specify number of cases and controls.%0a> %0a> # Calculate minimal detectable relative risk.%0a> Given number of cases and controls and power, calculate minimal detectable%0a> relative risk.%0a> %0a> # Calculate needed samples from ratio between controls / cases%0a> Given power and relative risk, calculate number of cases and controls from %0a> a ratio.%0a> %0a> # Calculate needed cased from fixed controls.%0a> Given power and relative risk, calculate number of cases and controls from %0a> a fixed number of controls.%0a> %0a> # Calculate needed cased from fixed cases.%0a> Given power and relative risk, calculate number of cases and controls from %0a> a fixed number of cases.%0a
host:1272376599=127.0.0.1
author:1272376486=
diff:1272376486:1272376318:=27c27%0a%3c -->@@> caseControlPower.py@@%0a---%0a> -->@@caseControlPower.py@@%0a29c29%0a%3c -->@@> caseControlPower.py --gui=False@@%0a---%0a> -->@@caseControlPower.py --gui=False@@%0a31c31%0a%3c -->@@> caseControlPower.py --help@@%0a---%0a> -->@@caseControlPower.py --help@@%0a53c53%0a%3c # Calculate power:%0a---%0a> 1. Calculate power:%0a57c57%0a%3c # Calculate minimal detectable relative risk.%0a---%0a> 2. Calculate minimal detectable relative risk.%0a61c61%0a%3c # Calculate needed samples from ratio between controls / cases%0a---%0a> 3. Calculate needed samples from ratio between controls / cases%0a65c65%0a%3c # Calculate needed cased from fixed controls.%0a---%0a> 4. Calculate needed cased from fixed controls.%0a69c69%0a%3c # Calculate needed cased from fixed cases.%0a---%0a> 4. Calculate needed cased from fixed cases.%0a83,84d82%0a%3c %0a%3c !!! Reference to command line parameters%0a
host:1272376486=127.0.0.1
author:1272376318=
diff:1272376318:1272376289:=15c15%0a%3c ->'''Power analysis for case–control association studies of samples with known family histories'''%0a---%0a> ->"""Power analysis for case–control association studies of samples with known family histories"""%0a
host:1272376318=127.0.0.1
author:1272376289=
diff:1272376289:1272376203:=15c15%0a%3c ->"""Power analysis for case–control association studies of samples with known family histories"""%0a---%0a> ->Power analysis for case–control association studies of samples with known family histories%0a27,32c27,32%0a%3c -->@@caseControlPower.py@@%0a%3c ->to start a graphical user interface, or use%0a%3c -->@@caseControlPower.py --gui=False@@%0a%3c ->to use interactive user input. You can use%0a%3c -->@@caseControlPower.py --help@@%0a%3c ->to check allowed command line options. You can also import this script as a module in another script and use the functions directly.%0a---%0a> ->caseControlPower.py%0a> to start a graphical user interface, or use%0a> ->caseControlPower.py --gui=False%0a> to use interactive user input. You can use%0a> ->caseControlPower.py --help%0a> to check allowed command line options.%0a
host:1272376289=127.0.0.1
author:1272376203=
diff:1272376203:1270420484:=6c6%0a%3c !!! Introduction%0a---%0a> %0a9c9%0a%3c know the family history of cases and/or controls. Because cases with known family%0a---%0a> know the family history of cases and/or contorls. Because cases with known family%0a12,34c12,13%0a%3c %0a%3c Please cite the following paper if you have used this script for your analysis:%0a%3c %0a%3c ->Power analysis for case–control association studies of samples with known family histories%0a%3c ->Bo Peng, Biao Li, Younghun Han and Christopher I. Amos%0a%3c ->LINK: http://www.springerlink.com/content/y85k314765524153/%0a%3c %0a%3c !!! Installation%0a%3c %0a%3c Because this script is written in Python and uses simuPOP for its graphical user interface, you will need to install Python (2.4 or higher, but not Python 3) and [[http://simupop.sf.net | simuPOP]] in order to use it. More specifically, you need to %0a%3c %0a%3c * Install Python if it is not available.%0a%3c * Download and install simuPOP following the installation instruction [[http://simupop.sourceforge.net/Main/Download | here]].%0a%3c * Download caseControlPower.py from this page and save it to a directory.%0a%3c * Open a """command window""", go to the directory with caseControlPower.py, type%0a%3c ->caseControlPower.py%0a%3c to start a graphical user interface, or use%0a%3c ->caseControlPower.py --gui=False%0a%3c to use interactive user input. You can use%0a%3c ->caseControlPower.py --help%0a%3c to check allowed command line options.%0a%3c %0a%3c !!! How to use this script%0a---%0a> Please refer to Peng et al 2010, Human Genetics for a complete analysis.%0a> %0a
host:1272376203=127.0.0.1
author:1270420484=
diff:1270420484:1270420446:=60c60%0a%3c steps. Please refer to script [[Attach:PowerAnalysis.py | PowerAnalysis.py]] for an example. That script%0a---%0a> steps. Please refer to script [[Attach:PowerAnalysis.py]] for an example. That script%0a
host:1270420484=127.0.0.1
author:1270420446=
diff:1270420446:1270420296:=60c60%0a%3c steps. Please refer to script [[Attach:PowerAnalysis.py]] for an example. That script%0a---%0a> steps. Please refer to script PowerAnalysis.py for an example. That script%0a
host:1270420446=127.0.0.1
author:1270420296=
diff:1270420296:1264976321:=6,62c6,8%0a%3c %0a%3c This program is a power calculator for case-control association studies. Compared%0a%3c to other power calculators, this program is unique in that it assumes that we%0a%3c know the family history of cases and/or contorls. Because cases with known family%0a%3c history have higher probability of carrying a disease predisposing loci, such%0a%3c study design is more powerful than regular case control association studies.%0a%3c Please refer to Peng et al 2010, Human Genetics for a complete analysis.%0a%3c %0a%3c Our analysis assumes a disease predisposing locus and a marker locus that are%0a%3c both in Hardy Weinberg Equilibrium. To calculate the power to detect a %0a%3c particular disease, you will need to disease mode (addition, recessive etc),%0a%3c prevalence, disease allele frequency, marker allele frequency, linkage%0a%3c disequilibrium between two loci (default to complete linkage), types of%0a%3c cases and controls, genotype relative risk and significance level.%0a%3c %0a%3c Cases and controls should be specified as a dictionary of cases or controls with%0a%3c different types. The pedigree types are  presented as a string of affection status%0a%3c of father, mother, proband, and optional siblings of the proband. The affection%0a%3c status is specified as 'A' for affected, 'U' for unaffected', and '*' for unknown.%0a%3c For example, to calculate the power of two mixing pedigree types, you can use %0a%3c   cases = "{'**A': 100, '**AA': 200}"%0a%3c which has 100 regular cases and 200 cases with an affected sibling. Of course, %0a%3c regular controls has the third letter as 'U'.%0a%3c %0a%3c This script can carry out the following functions:%0a%3c %0a%3c 1. Calculate power:%0a%3c Given the number of cases of each pedigree type and genotype relative risk,%0a%3c calculate statistical power. You should specify number of cases and controls.%0a%3c %0a%3c 2. Calculate minimal detectable relative risk.%0a%3c Given number of cases and controls and power, calculate minimal detectable%0a%3c relative risk.%0a%3c %0a%3c 3. Calculate needed samples from ratio between controls / cases%0a%3c Given power and relative risk, calculate number of cases and controls from %0a%3c a ratio.%0a%3c %0a%3c 4. Calculate needed cased from fixed controls.%0a%3c Given power and relative risk, calculate number of cases and controls from %0a%3c a fixed number of controls.%0a%3c %0a%3c 4. Calculate needed cased from fixed cases.%0a%3c Given power and relative risk, calculate number of cases and controls from %0a%3c a fixed number of cases.%0a%3c %0a%3c This script accepts a large number of parameters and some of them are%0a%3c hidden in the sense that they are not accessible from the graphical user%0a%3c interface. Please refer the description of each parameter for details.%0a%3c %0a%3c In addition to command line (you can use --gui=False to use this script in batch%0a%3c mode) and a graphical user interface, you can also import this script and use %0a%3c the functions directly from another script. This will allow you to run a large%0a%3c number of analyses easily and use a logging object to dump important internal%0a%3c steps. Please refer to script PowerAnalysis.py for an example. That script%0a%3c loads caseControlPower.py and performs all calculates for Peng et al, 2010.%0a%3c %0a---%0a> This script calculates the power of a case control study. It makes use of the graphical user interface and statistical calculation functions of simuPOP so simuPOP has to be installed. This script can be executed from commandline (use --gui=False to run in batch mode), using a parameter input dialog, or be imported from another Python script for more detailed analysis. A detailed description of the theoretical model and its analysis will be provided soon.%0a> %0a> %0a71,85d16%0a%3c                         Disease models with different relationship between risks%0a%3c                         of AA, AB and BB, and different definitions of genotype%0a%3c                         relative risk. Let A be the disease allele, and r_AA,%0a%3c                         r_AB and r_BB be the penetrance of genotypes AA, AB and%0a%3c                         BB respectively, six disease types are provided for this%0a%3c                         analysis. Additive_AA and LogAdditive are alternatives%0a%3c                         of types Additive and Multiplicative by using%0a%3c                         alternative definitions of genotype relative risks.%0a%3c                           Dominant:  r_AB=r_AA, Grr = r_AA / r_BB%0a%3c                           Recessive: r_AB=r_BB, Grr = r_AA / r_BB%0a%3c                           Multiplicative: r_AB=sqrt(r_AA * r_BB), Grr = r_AB /%0a%3c                         r_BB%0a%3c                           Additive:  r_AB=(r_AA + r_BB)/2, Grr = r_AB / r_BB%0a%3c                           Additive_AA: r_AB=(r_AA + r_BB)/2, Grr = r_AA / r_BB%0a%3c                           LogAdditive: r_AB=sqrt(r_AA * r_BB), Grr = r_AA / r_BB%0a88c19%0a%3c   --x ARG               Marker allele frequency [default: 0 ]%0a---%0a>   --x ARG               Marker allele frequency if D' != 1 [default: 0 ]%0a92,106c23%0a%3c   --genoP ARG           [default: 0 ]%0a%3c                         This option is hidden. If specified, it overrides%0a%3c                         parameter p and specifies the frequency of causal%0a%3c                         genotypes so that%0a%3c                           p=sqrt(genoP) for a recessive model (frequency of AA).%0a%3c                           p=1-sqrt(1-genoP) for other models (frequency of AA +%0a%3c                         AB)%0a%3c   --genoX ARG           [default: 0 ]%0a%3c                         This option is hidden. If specified, it overrides%0a%3c                         paramter x and specifies the frequency of causal%0a%3c                         genotypes at the marker locus so that%0a%3c                           p=sqrt(genoX) for a recessive model (frequency of AA).%0a%3c                           p=1-sqrt(1-genoX) for other models (frequency of AA +%0a%3c                         AB)%0a%3c   --Dprime ARG          LD (D') [default: 1 ]%0a---%0a>   --LD ARG              LD (D') [default: 1 ]%0a108,113c25%0a%3c                         disease locus. Only one of parameters Dprime and R2%0a%3c                         should be specified.%0a%3c   --R2 ARG              LD (R2) [default: 1 ]%0a%3c                         Linkage disequilibrium (R2) between marker locus and%0a%3c                         disease locus. Only one of the parameters Dprime and R2%0a%3c                         should be specified.%0a---%0a>                         disease locus%0a116,132c28%0a%3c                         the specification of different parameters. More%0a%3c                         specifically,%0a%3c                         Statistical power: fix number of cases and controls,%0a%3c                         alpha, Grr, calculate power. Ignore ratio.%0a%3c                         Minimal detectable relative risk: fix number of cases%0a%3c                         and controls, alpha, power, calculate Grr. Ignore ratio.%0a%3c                         Sample size from #ctrl/#case: number of cases and%0a%3c                         controls treats as weights, fix ratio, alpha, Grr,%0a%3c                         power, calculate sample size.%0a%3c                         Sample size from fixed #ctrl: Fix number of controls,%0a%3c                         alpha, Grr, power and calculate number of cases. Ignore%0a%3c                         ratio. Numbers of different types of cases are treated%0a%3c                         as weights.%0a%3c                         Sample size from fixed #cases: Fix number of cases,%0a%3c                         alpha, Grr, power and calculate number of controls.%0a%3c                         Ignore ratio. Number of different types of controls are%0a%3c                         treated as weights.%0a---%0a>                         the specification of different parameters%0a134,136c30,32%0a%3c                         Type and number of cases. The counts will be considered%0a%3c                         as weights in 'sample size from #ctrl/#case', and%0a%3c                         'sample size from fixed #ctrl' analysis%0a---%0a>                         Type and number of cases. The count will be considered%0a>                         as weight in 'sample size from #ctrl/#case', and 'sample%0a>                         size from fixed #ctrl' analysis%0a138,139c34,35%0a%3c                         Type and number of controls. The counts will be%0a%3c                         considered as weights in 'Sample size from #ctrl/#case'.%0a---%0a>                         Type and number of controls. The count will be%0a>                         considered as weight in 'Sample size from #ctrl/#case'.%0a141,142c37%0a%3c                         Ratio, use for calculate sample size from the ratio of%0a%3c                         #ctrl to #case%0a---%0a>                         Ratio, use for calculate sample size from #ctrl/#case%0a148,150c43,52%0a%3c                         Relative genotype risk for a disease model. The exact%0a%3c                         definition of this quantity depends on the disease%0a%3c                         model.%0a---%0a>                         Minimal detactable relative risk if number of cases and%0a>                         statistical power are specified. Otherwise, it specifies%0a>                         relative risk for a disease model. If f0, f1, f2 are the%0a>                         probability of being affected for individuals with 0, 1%0a>                         or 2 copies of the risk allele A, the Grr is defined as%0a>                           Multiplicative: Grr = f1/f0 = f2/f1 (NOTE: f2/f1 =%0a>                         f1/f0)%0a>                           Additive: Grr = f1/f0 (NOTE: f2 - f1 = f1 - f0)%0a>                           Dominant: Grr = f1/f0 = f2/f0 (NOTE: f1 = f2)%0a>                           Recessive: Grr = f2/f0 = f2/f1 (NOTE: f0 = f1)%0a
host:1270420296=127.0.0.1
author:1264976321=
diff:1264976321:1264957460:=1c1%0a%3c (:title A power calculator for case control association studies of samples with  known family histories:)%0a---%0a> (:title A power calculator for case control association studies with known family history:)%0a
host:1264976321=127.0.0.1
author:1264957460=
diff:1264957460:1261000329:=6,52c6%0a%3c This script calculates the power of a case control study. It makes use of the graphical user interface and statistical calculation functions of simuPOP so simuPOP has to be installed. This script can be executed from commandline (use --gui=False to run in batch mode), using a parameter input dialog, or be imported from another Python script for more detailed analysis. A detailed description of the theoretical model and its analysis will be provided soon.%0a%3c %0a%3c %0a%3c usage: caseControlPower.py [-opt [arg] | --opt [=arg]] ...%0a%3c %0a%3c options:%0a%3c   -h, --help            show this help message and exit%0a%3c   --config ARG          load parameters from ARG%0a%3c   --optimized           run the script using an optimized simuPOP module%0a%3c   --gui ARG             which graphical toolkit to use%0a%3c   --mode ARG            Mode of inheritance [default: Additive ]%0a%3c   --K ARG               Disease prevalence [default: 0.05 ]%0a%3c   --p ARG               Disease allele frequency [default: 0.15 ]%0a%3c   --x ARG               Marker allele frequency if D' != 1 [default: 0 ]%0a%3c                         Marker allele frequency. If LD is 1, this parameter is%0a%3c                         ignored because it will be assumed to be the same as%0a%3c                         disease allele frequency.%0a%3c   --LD ARG              LD (D') [default: 1 ]%0a%3c                         Linkage disequilibrium (D') between marker locus and%0a%3c                         disease locus%0a%3c   --analysis ARG        Type of analysis [default: Statistical power ]%0a%3c                         Perform different types of calculations, each require%0a%3c                         the specification of different parameters%0a%3c   --cases ARG           #cases [default: {'**A': 1000} ]%0a%3c                         Type and number of cases. The count will be considered%0a%3c                         as weight in 'sample size from #ctrl/#case', and 'sample%0a%3c                         size from fixed #ctrl' analysis%0a%3c   --controls ARG        #controls [default: {'**U': 1000} ]%0a%3c                         Type and number of controls. The count will be%0a%3c                         considered as weight in 'Sample size from #ctrl/#case'.%0a%3c   --ratio ARG           #controls / #cases for analysis 3 [default: 1 ]%0a%3c                         Ratio, use for calculate sample size from #ctrl/#case%0a%3c   --alpha ARG           Significant level [default: 1e-07 ]%0a%3c   --power ARG           Power [default: 0.8 ]%0a%3c                         Power of a case-control assocition test if number cases%0a%3c                         and relative risk are specified%0a%3c   --Grr ARG             Genotype Relative risk [default: 1.2 ]%0a%3c                         Minimal detactable relative risk if number of cases and%0a%3c                         statistical power are specified. Otherwise, it specifies%0a%3c                         relative risk for a disease model. If f0, f1, f2 are the%0a%3c                         probability of being affected for individuals with 0, 1%0a%3c                         or 2 copies of the risk allele A, the Grr is defined as%0a%3c                           Multiplicative: Grr = f1/f0 = f2/f1 (NOTE: f2/f1 =%0a%3c                         f1/f0)%0a%3c                           Additive: Grr = f1/f0 (NOTE: f2 - f1 = f1 - f0)%0a%3c                           Dominant: Grr = f1/f0 = f2/f0 (NOTE: f1 = f2)%0a%3c                           Recessive: Grr = f2/f0 = f2/f1 (NOTE: f0 = f1)%0a---%0a> %0a
host:1264957460=127.0.0.1
author:1261000329=
diff:1261000329:1261000329:=1,6d0%0a%3c (:title A power calculator for case control association studies with known family history:)%0a%3c %0a%3c %0a%3c %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:caseControlPower.py | http://simupop.sourceforge.net/images/download.jpg]]|caseControlPower.py%0a%3c %0a%3c %0a
host:1261000329=127.0.0.1
