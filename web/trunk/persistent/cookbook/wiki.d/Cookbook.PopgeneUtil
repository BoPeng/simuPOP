version=pmwiki-2.2.0 ordered=1 urlencoded=1
agent=Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.1.1) Gecko/20090715 Firefox/3.5.1 (.NET CLR 3.5.30729)
author=
charset=ISO-8859-1
csum=
ctime=1238103697
host=127.0.0.1
name=Cookbook.PopgeneUtil
rev=16
targets=
text=(:title Export POPGENE data file:)%0a%0a%25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:popgeneUtil.py | http://simupop.sourceforge.net/images/download.jpg]]|popgeneUtil.py%0a%0aThis function allows you to export your simulated populations into a POPGENE readable data file.%0a%0aPOPGENE is a user-friendly Microsoft Window-based computer package for the analysis of genetic variation among and within natural populations using co-dominant and dominant markers and quantitative traits. It can be downloaded from:%0ahttp://www.ualberta.ca/~fyeh/index.htm%0a%0aInput file for POPGENE analysis consists of the header section and the data. The header section specifies %0a# a job title delimited by /* ... */; %0a# number of populations; %0a# number of loci and %0a# locus names. %0a%0aThe body of data starts with, for each population, population ID # (optional), population name (optional). If you do not give population ID # or population name, you must leave at least one blank line between populations and POPGENE will generate population ID # automatically for you. But if you do, your population ID # and population name must be unique for each population. The raw data, in free format and with or without one or more spaces between columns, immediately follow without blank lines in between. Missing values must be set to “ . ‘‘ for haploids and dominant markers such as RAPDs (i.e., one digit to score for presence or absence of allele) and “..” (i.e., two digits) for diploids co-dominant markers in your input file. %0a%0a%0aUsing the following function,%0a %0a=python [=%0adef SavePOPGENEDatFile(pop, output='', title='', pad=1):%0a    '''%0a    Output a data file readable by POPGENE%0a    pad - shift genotype from 0 to pad, 1 to 1+pad...%0a          since POPGENE genotype can not be 0 %0a    '''%0a    if type(pop) == type(''):%0a        pop = LoadPopulation(pop)%0a    # open data file to write%0a    try:%0a        datOut = open(output, "w")%0a    except exceptions.IOError:%0a        raise exceptions.IOError, "Can not open file " + file + " to write."%0a    # header section of POPGENE data file, default to output%0a    if title != '':%0a        print >> datOut, '/* ' + title + ' */'%0a    else:%0a        print >> datOut, '/* ' + output + ' */'%0a    print >> datOut, 'Number of populations = %25d' %25 pop.numSubPop()%0a    print >> datOut, 'Number of loci = %25d' %25 pop.totNumLoci()%0a    print >> datOut, 'Locus name :'%0a    # output locus names%0a    print >> datOut, ' '.join(pop.lociNames()) + '\n'%0a    # output genotype, only handle haploid and diploid%0a    if pop.ploidy() == 1:%0a        for sp in range(0, pop.numSubPop()):%0a            gt = ''%0a            # obtain genotype%0a            # POPGENE genotype can not be 0, so transfer 0 to pad, 1 to 1+pad...%0a            for g in pop.genotype(sp):%0a                if len(pop.alleleNames()) == 0:%0a                    gt += '%25d' %25 (g + pad)%0a                else:%0a                    gt += pop.alleleName(g)%0a            # add space after each genotype%0a            gt = ' '.join(gt)%0a            # add enter after each individual%0a            gt = '\n'.join(gt[i:i+2*pop.totNumLoci()] for i in range(len(gt)) %0a                if i %25 (2*pop.totNumLoci()) == 0)%0a            print >> datOut, gt%0a            print >> datOut, '\n'%0a    elif pop.ploidy() == 2:%0a        for sp in range(0, pop.numSubPop()):%0a            for ind in pop.individuals(sp):%0a                gt = ''%0a                for loc in range(pop.totNumLoci()):%0a                    if len(pop.alleleNames()) == 0:%0a                        gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad,%0a                            ind.allele(loc, 1) + pad)%0a                    else:%0a                        gt += pop.alleleName(ind.allele(loc, 0)) + \%0a                            pop.alleleName(ind.allele(loc, 1))%0a                    gt += ' '%0a                print >> datOut, gt%0a            print >> datOut, '\n'%0a    else:%0a        raise exceptions.ValueError, "POPGENE only supports haploid and diploid."%0a    datOut.close()%0a=]%0a%0aif we define the population as %0a=python [=%0a    pop = population(size=[4, 5], ploidy=2, loci=[2, 4], alleleNames=['A','B'])%0a    InitByFreq(pop, [.3, .7])%0a=]%0awe may get the output file%0a=python [=%0a/* testing diploid */%0aNumber of populations = 2%0aNumber of loci = 6%0aLocus name :%0aloc1-1 loc1-2 loc2-1 loc2-2 loc2-3 loc2-4%0a%0aAB BA BA BB BB AB %0aBB AB BB AB BB BA %0aBB BB BA AA AB BB %0aAB BA AA AA BA BB %0a%0a%0aAA AB AB BA BB BA %0aBB AA AB BB AA BA %0aAA BB BB AB AA BB %0aAB BB BA BA BB BB %0aBB BB BB BB BB BA %0a%0a%0a=]%0a
time=1248197146
title=Export POPGENE data file
author:1248197146=
diff:1248197146:1248196761:=3c3%0a%3c %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:popgeneUtil.py | http://simupop.sourceforge.net/images/download.jpg]]|popgeneUtil.py%0a---%0a> %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:PopgeneUtil.py | http://simupop.sourceforge.net/images/download.jpg]]|PopgeneUtil.py%0a
host:1248197146=127.0.0.1
author:1248196761=
diff:1248196761:1246993495:=3c3%0a%3c %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:PopgeneUtil.py | http://simupop.sourceforge.net/images/download.jpg]]|PopgeneUtil.py%0a---%0a> %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:ExportPOPGENE.py | http://simupop.sourceforge.net/images/download.jpg]]|ExportPOPGENE.py%0a
host:1248196761=127.0.0.1
author:1246993495=
diff:1246993495:1246906600:=
host:1246993495=127.0.0.1
author:1246906600=
diff:1246906600:1246906434:=18d17%0a%3c %0a22,27c21,46%0a%3c def SavePOPGENEDatFile(pop, output='', title='', pad=1):%0a%3c     '''%0a%3c     Output a data file readable by POPGENE%0a%3c     pad - shift genotype from 0 to pad, 1 to 1+pad...%0a%3c           since POPGENE genotype can not be 0 %0a%3c     '''%0a---%0a> def SaveQTDT(pop, output='', loci=[], header=False,%0a>     affectionCode=['U', 'A'], fields=[], combine=None, shift=1, **kwargs):%0a>     """%0a>     save population in Merlin/QTDT format. The population must have pedindex,%0a>     father_idx and mother_idx information fields.%0a> %0a>     pop%0a>         population to be saved. If pop is a filename, it will be loaded.%0a>     output%0a>         base filename.%0a>     affectionCode%0a>         code for unaffected and affected. '1', '2' are default,%0a>         but 'U', and 'A' or others can be specified.%0a>     loci%0a>         loci to output%0a>     header%0a>         whether or not put head line in the ped file.%0a>     fields%0a>         information fields to output%0a>     combine%0a>         an optional function to combine two alleles of a diploid%0a>         individual.%0a>     shift%0a>         if combine is not given, output two alleles directly, adding%0a>         this value (default to 1).%0a>     """%0a30,37c49,55%0a%3c     # open data file to write%0a%3c     try:%0a%3c         datOut = open(output, "w")%0a%3c     except exceptions.IOError:%0a%3c         raise exceptions.IOError, "Can not open file " + file + " to write."%0a%3c     # header section of POPGENE data file, default to output%0a%3c     if title != '':%0a%3c         print >> datOut, '/* ' + title + ' */'%0a---%0a>     #%0a>     if loci == []:%0a>         loci = range(0, pop.totNumLoci())%0a>     # write dat file%0a>     if 'affection' in fields:%0a>         outputAffection = True%0a>         fields.remove('affection')%0a39,79c57,63%0a%3c         print >> datOut, '/* ' + output + ' */'%0a%3c     print >> datOut, 'Number of populations = %25d' %25 pop.numSubPop()%0a%3c     print >> datOut, 'Number of loci = %25d' %25 pop.totNumLoci()%0a%3c     print >> datOut, 'Locus name :'%0a%3c     # output locus names%0a%3c     print >> datOut, ' '.join(pop.lociNames()) + '\n'%0a%3c     # output genotype, only handle haploid and diploid%0a%3c     if pop.ploidy() == 1:%0a%3c         for sp in range(0, pop.numSubPop()):%0a%3c             gt = ''%0a%3c             # obtain genotype%0a%3c             # POPGENE genotype can not be 0, so transfer 0 to pad, 1 to 1+pad...%0a%3c             for g in pop.genotype(sp):%0a%3c                 if len(pop.alleleNames()) == 0:%0a%3c                     gt += '%25d' %25 (g + pad)%0a%3c                 else:%0a%3c                     gt += pop.alleleName(g)%0a%3c             # add space after each genotype%0a%3c             gt = ' '.join(gt)%0a%3c             # add enter after each individual%0a%3c             gt = '\n'.join(gt[i:i+2*pop.totNumLoci()] for i in range(len(gt)) %0a%3c                 if i %25 (2*pop.totNumLoci()) == 0)%0a%3c             print >> datOut, gt%0a%3c             print >> datOut, '\n'%0a%3c     elif pop.ploidy() == 2:%0a%3c         for sp in range(0, pop.numSubPop()):%0a%3c             for ind in pop.individuals(sp):%0a%3c                 gt = ''%0a%3c                 for loc in range(pop.totNumLoci()):%0a%3c                     if len(pop.alleleNames()) == 0:%0a%3c                         gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad,%0a%3c                             ind.allele(loc, 1) + pad)%0a%3c                     else:%0a%3c                         gt += pop.alleleName(ind.allele(loc, 0)) + \%0a%3c                             pop.alleleName(ind.allele(loc, 1))%0a%3c                     gt += ' '%0a%3c                 print >> datOut, gt%0a%3c             print >> datOut, '\n'%0a%3c     else:%0a%3c         raise exceptions.ValueError, "POPGENE only supports haploid and diploid."%0a%3c     datOut.close()%0a---%0a>         outputAffection = False%0a>     SaveMerlinDatFile(pop, output, loci, fields, outputAffection)%0a>     # write map file%0a>     SaveMerlinMapFile(pop, output, loci)%0a>     # write ped file%0a>     SaveMerlinPedFile(pop, output, loci, fields, header,%0a>         outputAffection, affectionCode, combine, shift)%0a82c66%0a%3c if we define the population as %0a---%0a> if we define the population in a simple way without infoFields or ancestral generations%0a84,85c68,69%0a%3c     pop = population(size=[4, 5], ploidy=2, loci=[2, 4], alleleNames=['A','B'])%0a%3c     InitByFreq(pop, [.3, .7])%0a---%0a>     pop = population(size=[2,3,4], loci=[1, 2])%0a>     InitByFreq(pop, [.1, .2, .3, .4])%0a89,107c73,100%0a%3c /* testing diploid */%0a%3c Number of populations = 2%0a%3c Number of loci = 6%0a%3c Locus name :%0a%3c loc1-1 loc1-2 loc2-1 loc2-2 loc2-3 loc2-4%0a%3c %0a%3c AB BA BA BB BB AB %0a%3c BB AB BB AB BB BA %0a%3c BB BB BA AA AB BB %0a%3c AB BA AA AA BA BB %0a%3c %0a%3c %0a%3c AA AB AB BA BB BA %0a%3c BB AA AB BB AA BA %0a%3c AA BB BB AB AA BB %0a%3c AB BB BA BA BB BB %0a%3c BB BB BB BB BB BA %0a%3c %0a%3c %0a---%0a> /* MERLIN data file */%0a> M	loc1-1%0a> M	loc2-1%0a> M	loc2-2%0a> %0a> /* MERLIN map file */%0a> CHROMOSOME MARKER POSITION%0a> 1	loc1-1	1.000000%0a> 2	loc2-1	1.000000%0a> 2	loc2-2	2.000000%0a> %0a> /* MERLIN pedigree file */%0a> 1 1 0 0 2 4 3 2 3 4 3%0a> 1 2 0 0 2 4 2 2 4 4 4%0a> 1 3 0 0 2 4 2 3 4 1 4%0a> 1 4 0 0 1 3 3 3 4 4 4%0a> 1 5 0 0 2 2 4 4 3 3 4%0a> 1 6 0 0 2 3 3 3 4 2 1%0a> 1 7 0 0 2 1 3 1 3 3 3%0a> 1 8 0 0 2 2 3 4 2 4 3%0a> 1 9 0 0 1 4 3 2 2 2 2%0a> =]%0a> %0a> if we define the population with required infoFiels and evolve several generations%0a> =python [=%0a>     =]%0a> we may get the output file%0a> =python [=%0a
host:1246906600=127.0.0.1
author:1246906434=
diff:1246906434:1238117560:=21,46c21,26%0a%3c def SaveQTDT(pop, output='', loci=[], header=False,%0a%3c     affectionCode=['U', 'A'], fields=[], combine=None, shift=1, **kwargs):%0a%3c     """%0a%3c     save population in Merlin/QTDT format. The population must have pedindex,%0a%3c     father_idx and mother_idx information fields.%0a%3c %0a%3c     pop%0a%3c         population to be saved. If pop is a filename, it will be loaded.%0a%3c     output%0a%3c         base filename.%0a%3c     affectionCode%0a%3c         code for unaffected and affected. '1', '2' are default,%0a%3c         but 'U', and 'A' or others can be specified.%0a%3c     loci%0a%3c         loci to output%0a%3c     header%0a%3c         whether or not put head line in the ped file.%0a%3c     fields%0a%3c         information fields to output%0a%3c     combine%0a%3c         an optional function to combine two alleles of a diploid%0a%3c         individual.%0a%3c     shift%0a%3c         if combine is not given, output two alleles directly, adding%0a%3c         this value (default to 1).%0a%3c     """%0a---%0a> def SavePOPGENEDatFile(pop, output='', title='', pad=1):%0a>     '''%0a>     Output a data file readable by POPGENE%0a>     pad - shift genotype from 0 to pad, 1 to 1+pad...%0a>           since POPGENE genotype can not be 0 %0a>     '''%0a49,55c29,36%0a%3c     #%0a%3c     if loci == []:%0a%3c         loci = range(0, pop.totNumLoci())%0a%3c     # write dat file%0a%3c     if 'affection' in fields:%0a%3c         outputAffection = True%0a%3c         fields.remove('affection')%0a---%0a>     # open data file to write%0a>     try:%0a>         datOut = open(output, "w")%0a>     except exceptions.IOError:%0a>         raise exceptions.IOError, "Can not open file " + file + " to write."%0a>     # header section of POPGENE data file, default to output%0a>     if title != '':%0a>         print >> datOut, '/* ' + title + ' */'%0a57,63c38,78%0a%3c         outputAffection = False%0a%3c     SaveMerlinDatFile(pop, output, loci, fields, outputAffection)%0a%3c     # write map file%0a%3c     SaveMerlinMapFile(pop, output, loci)%0a%3c     # write ped file%0a%3c     SaveMerlinPedFile(pop, output, loci, fields, header,%0a%3c         outputAffection, affectionCode, combine, shift)%0a---%0a>         print >> datOut, '/* ' + output + ' */'%0a>     print >> datOut, 'Number of populations = %25d' %25 pop.numSubPop()%0a>     print >> datOut, 'Number of loci = %25d' %25 pop.totNumLoci()%0a>     print >> datOut, 'Locus name :'%0a>     # output locus names%0a>     print >> datOut, ' '.join(pop.lociNames()) + '\n'%0a>     # output genotype, only handle haploid and diploid%0a>     if pop.ploidy() == 1:%0a>         for sp in range(0, pop.numSubPop()):%0a>             gt = ''%0a>             # obtain genotype%0a>             # POPGENE genotype can not be 0, so transfer 0 to pad, 1 to 1+pad...%0a>             for g in pop.genotype(sp):%0a>                 if len(pop.alleleNames()) == 0:%0a>                     gt += '%25d' %25 (g + pad)%0a>                 else:%0a>                     gt += pop.alleleName(g)%0a>             # add space after each genotype%0a>             gt = ' '.join(gt)%0a>             # add enter after each individual%0a>             gt = '\n'.join(gt[i:i+2*pop.totNumLoci()] for i in range(len(gt)) %0a>                 if i %25 (2*pop.totNumLoci()) == 0)%0a>             print >> datOut, gt%0a>             print >> datOut, '\n'%0a>     elif pop.ploidy() == 2:%0a>         for sp in range(0, pop.numSubPop()):%0a>             for ind in pop.individuals(sp):%0a>                 gt = ''%0a>                 for loc in range(pop.totNumLoci()):%0a>                     if len(pop.alleleNames()) == 0:%0a>                         gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad,%0a>                             ind.allele(loc, 1) + pad)%0a>                     else:%0a>                         gt += pop.alleleName(ind.allele(loc, 0)) + \%0a>                             pop.alleleName(ind.allele(loc, 1))%0a>                     gt += ' '%0a>                 print >> datOut, gt%0a>             print >> datOut, '\n'%0a>     else:%0a>         raise exceptions.ValueError, "POPGENE only supports haploid and diploid."%0a>     datOut.close()%0a66c81%0a%3c if we define the population in a simple way without infoFields or ancestral generations%0a---%0a> if we define the population as %0a68,69c83,84%0a%3c     pop = population(size=[2,3,4], loci=[1, 2])%0a%3c     InitByFreq(pop, [.1, .2, .3, .4])%0a---%0a>     pop = population(size=[4, 5], ploidy=2, loci=[2, 4], alleleNames=['A','B'])%0a>     InitByFreq(pop, [.3, .7])%0a73,100c88,106%0a%3c /* MERLIN data file */%0a%3c M	loc1-1%0a%3c M	loc2-1%0a%3c M	loc2-2%0a%3c %0a%3c /* MERLIN map file */%0a%3c CHROMOSOME MARKER POSITION%0a%3c 1	loc1-1	1.000000%0a%3c 2	loc2-1	1.000000%0a%3c 2	loc2-2	2.000000%0a%3c %0a%3c /* MERLIN pedigree file */%0a%3c 1 1 0 0 2 4 3 2 3 4 3%0a%3c 1 2 0 0 2 4 2 2 4 4 4%0a%3c 1 3 0 0 2 4 2 3 4 1 4%0a%3c 1 4 0 0 1 3 3 3 4 4 4%0a%3c 1 5 0 0 2 2 4 4 3 3 4%0a%3c 1 6 0 0 2 3 3 3 4 2 1%0a%3c 1 7 0 0 2 1 3 1 3 3 3%0a%3c 1 8 0 0 2 2 3 4 2 4 3%0a%3c 1 9 0 0 1 4 3 2 2 2 2%0a%3c =]%0a%3c %0a%3c if we define the population with required infoFiels and evolve several generations%0a%3c =python [=%0a%3c     =]%0a%3c we may get the output file%0a%3c =python [=%0a---%0a> /* testing diploid */%0a> Number of populations = 2%0a> Number of loci = 6%0a> Locus name :%0a> loc1-1 loc1-2 loc2-1 loc2-2 loc2-3 loc2-4%0a> %0a> AB BA BA BB BB AB %0a> BB AB BB AB BB BA %0a> BB BB BA AA AB BB %0a> AB BA AA AA BA BB %0a> %0a> %0a> AA AB AB BA BB BA %0a> BB AA AB BB AA BA %0a> AA BB BB AB AA BB %0a> AB BB BA BA BB BB %0a> BB BB BB BB BB BA %0a> %0a> %0a
host:1246906434=127.0.0.1
author:1238117560=
diff:1238117560:1238107960:=10,16c10%0a%3c Input file for POPGENE analysis consists of the header section and the data. The header section specifies %0a%3c # a job title delimited by /* ... */; %0a%3c # number of populations; %0a%3c # number of loci and %0a%3c # locus names. %0a%3c %0a%3c The body of data starts with, for each population, population ID # (optional), population name (optional). If you do not give population ID # or population name, you must leave at least one blank line between populations and POPGENE will generate population ID # automatically for you. But if you do, your population ID # and population name must be unique for each population. The raw data, in free format and with or without one or more spaces between columns, immediately follow without blank lines in between. Missing values must be set to “ . ‘‘ for haploids and dominant markers such as RAPDs (i.e., one digit to score for presence or absence of allele) and “..” (i.e., two digits) for diploids co-dominant markers in your input file. %0a---%0a> Input file for POPGENE analysis consists of the header section and the data. The header section specifies (1) a job title delimited by /* ... */; (2) number of populations; (3) number of loci and (4) locus names. The body of data starts with, for each population, population ID # (optional), population name (optional). If you do not give population ID # or population name, you must leave at least one blank line between populations and POPGENE will generate population ID # automatically for you. But if you do, your population ID # and population name must be unique for each population. The raw data, in free format and with or without one or more spaces between columns, immediately follow without blank lines in between. Missing values must be set to “ . ‘‘ for haploids and dominant markers such as RAPDs (i.e., one digit to score for presence or absence of allele) and “..” (i.e., two digits) for diploids co-dominant markers in your input file. %0a
host:1238117560=127.0.0.1
author:1238107960=Yaji Xu
diff:1238107960:1238107877:=81c81%0a%3c =python [=%0a---%0a> = python [=%0a98a99%0a> %0a
host:1238107960=127.0.0.1
author:1238107877=Yaji Xu
diff:1238107877:1238107804:=81c81%0a%3c = python [=%0a---%0a> [=%0a
host:1238107877=127.0.0.1
author:1238107804=Yaji Xu
diff:1238107804:1238107391:=12c12%0a%3c Using the following function,%0a---%0a> Using the following function and %0a13a14,15%0a> %0a> %0a73,102c75%0a%3c =]%0a%3c %0a%3c if we define the population as %0a%3c =python [=%0a%3c     pop = population(size=[4, 5], ploidy=2, loci=[2, 4], alleleNames=['A','B'])%0a%3c     InitByFreq(pop, [.3, .7])%0a%3c =]%0a%3c we may get the output file%0a%3c [=%0a%3c /* testing diploid */%0a%3c Number of populations = 2%0a%3c Number of loci = 6%0a%3c Locus name :%0a%3c loc1-1 loc1-2 loc2-1 loc2-2 loc2-3 loc2-4%0a%3c %0a%3c AB BA BA BB BB AB %0a%3c BB AB BB AB BB BA %0a%3c BB BB BA AA AB BB %0a%3c AB BA AA AA BA BB %0a%3c %0a%3c %0a%3c AA AB AB BA BB BA %0a%3c BB AA AB BB AA BA %0a%3c AA BB BB AB AA BB %0a%3c AB BB BA BA BB BB %0a%3c BB BB BB BB BB BA %0a%3c %0a%3c %0a%3c %0a%3c =]%0a---%0a> =]%0a\ No newline at end of file%0a
host:1238107804=127.0.0.1
author:1238107391=Yaji Xu
diff:1238107391:1238106811:=7,15c7%0a%3c POPGENE is a user-friendly Microsoft Window-based computer package for the analysis of genetic variation among and within natural populations using co-dominant and dominant markers and quantitative traits. It can be downloaded from:%0a%3c http://www.ualberta.ca/~fyeh/index.htm%0a%3c %0a%3c Input file for POPGENE analysis consists of the header section and the data. The header section specifies (1) a job title delimited by /* ... */; (2) number of populations; (3) number of loci and (4) locus names. The body of data starts with, for each population, population ID # (optional), population name (optional). If you do not give population ID # or population name, you must leave at least one blank line between populations and POPGENE will generate population ID # automatically for you. But if you do, your population ID # and population name must be unique for each population. The raw data, in free format and with or without one or more spaces between columns, immediately follow without blank lines in between. Missing values must be set to “ . ‘‘ for haploids and dominant markers such as RAPDs (i.e., one digit to score for presence or absence of allele) and “..” (i.e., two digits) for diploids co-dominant markers in your input file. %0a%3c %0a%3c Using the following function and %0a%3c  %0a%3c %0a%3c %0a---%0a> %0a74a67%0a> %0a
host:1238107391=127.0.0.1
author:1238106811=Yaji Xu
diff:1238106811:1238106610:=10,14c10%0a%3c     '''%0a%3c     Output a data file readable by POPGENE%0a%3c     pad - shift genotype from 0 to pad, 1 to 1+pad...%0a%3c           since POPGENE genotype can not be 0 %0a%3c     '''%0a---%0a>     '''Output a data file readable by POPGENE'''%0a16a13,16%0a>     if output != '':%0a>         file = output%0a>     else:%0a>         raise exceptions.ValueError, "Please specify output file."%0a19c19%0a%3c         datOut = open(output, "w")%0a---%0a>         datOut = open(file, "w")%0a39c39%0a%3c                 if len(pop.alleleNames()) == 0:%0a---%0a>                 if pop.alleleNames() == ():%0a55,56c55,56%0a%3c                     if len(pop.alleleNames()) == 0:%0a%3c                         gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad,%0a---%0a>                     if pop.alleleNames() == ():%0a>                         gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad, %0a59c59%0a%3c                         gt += pop.alleleName(ind.allele(loc, 0)) + \%0a---%0a>                         gt += pop.alleleName(ind.allele(loc, 0)) + %0a
host:1238106811=127.0.0.1
author:1238106610=Yaji Xu
diff:1238106610:1238104469:=3c3%0a%3c %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:ExportPOPGENE.py | http://simupop.sourceforge.net/images/download.jpg]]|ExportPOPGENE.py%0a---%0a> %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:ExportPG.py | http://simupop.sourceforge.net/images/download.jpg]]|ExportPG.py%0a
host:1238106610=127.0.0.1
author:1238104469=Yaji Xu
diff:1238104469:1238104356:=56,57c56%0a%3c                         gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad, %0a%3c                             ind.allele(loc, 1) + pad)%0a---%0a>                         gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad, ind.allele(loc, 1) + pad)%0a59,60c58%0a%3c                         gt += pop.alleleName(ind.allele(loc, 0)) + %0a%3c                             pop.alleleName(ind.allele(loc, 1))%0a---%0a>                         gt += pop.alleleName(ind.allele(loc, 0)) + pop.alleleName(ind.allele(loc, 1))%0a
host:1238104469=127.0.0.1
author:1238104356=Yaji Xu
diff:1238104356:1238104205:=5,6c5%0a%3c This function allows you to export your simulated populations into a POPGENE readable data file.%0a%3c %0a---%0a> This function allows you to export your simulated population into a POPGENE readable data file.%0a
host:1238104356=127.0.0.1
author:1238104205=Yaji Xu
diff:1238104205:1238103697:=3,5c3,5%0a%3c %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:ExportPG.py | http://simupop.sourceforge.net/images/download.jpg]]|ExportPG.py%0a%3c %0a%3c This function allows you to export your simulated population into a POPGENE readable data file.%0a---%0a> %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:restartIfFailed.py | http://simupop.sourceforge.net/images/download.jpg]]|restartIfFailed.py%0a> %0a> This example is simple but can be easily applied to cases when continuing a forward-time simulation will not yield meaning results. One such example is a disease allele gets lost. Note that if you would like to control the allele frequency of an allele, [[Cookbook/ControlledRandomMating]] may be better.%0a
host:1238104205=127.0.0.1
author:1238103697=Yaji Xu
diff:1238103697:1238103697:=1,65d0%0a%3c (:title Export POPGENE data file:)%0a%3c %0a%3c %25rfloat text-align=center margin-top=5px margin-right=25px margin-bottom=15px margin-left=25px %25 [[Attach:restartIfFailed.py | http://simupop.sourceforge.net/images/download.jpg]]|restartIfFailed.py%0a%3c %0a%3c This example is simple but can be easily applied to cases when continuing a forward-time simulation will not yield meaning results. One such example is a disease allele gets lost. Note that if you would like to control the allele frequency of an allele, [[Cookbook/ControlledRandomMating]] may be better.%0a%3c %0a%3c =python [=%0a%3c def SavePOPGENEDatFile(pop, output='', title='', pad=1):%0a%3c     '''Output a data file readable by POPGENE'''%0a%3c     if type(pop) == type(''):%0a%3c         pop = LoadPopulation(pop)%0a%3c     if output != '':%0a%3c         file = output%0a%3c     else:%0a%3c         raise exceptions.ValueError, "Please specify output file."%0a%3c     # open data file to write%0a%3c     try:%0a%3c         datOut = open(file, "w")%0a%3c     except exceptions.IOError:%0a%3c         raise exceptions.IOError, "Can not open file " + file + " to write."%0a%3c     # header section of POPGENE data file, default to output%0a%3c     if title != '':%0a%3c         print >> datOut, '/* ' + title + ' */'%0a%3c     else:%0a%3c         print >> datOut, '/* ' + output + ' */'%0a%3c     print >> datOut, 'Number of populations = %25d' %25 pop.numSubPop()%0a%3c     print >> datOut, 'Number of loci = %25d' %25 pop.totNumLoci()%0a%3c     print >> datOut, 'Locus name :'%0a%3c     # output locus names%0a%3c     print >> datOut, ' '.join(pop.lociNames()) + '\n'%0a%3c     # output genotype, only handle haploid and diploid%0a%3c     if pop.ploidy() == 1:%0a%3c         for sp in range(0, pop.numSubPop()):%0a%3c             gt = ''%0a%3c             # obtain genotype%0a%3c             # POPGENE genotype can not be 0, so transfer 0 to pad, 1 to 1+pad...%0a%3c             for g in pop.genotype(sp):%0a%3c                 if pop.alleleNames() == ():%0a%3c                     gt += '%25d' %25 (g + pad)%0a%3c                 else:%0a%3c                     gt += pop.alleleName(g)%0a%3c             # add space after each genotype%0a%3c             gt = ' '.join(gt)%0a%3c             # add enter after each individual%0a%3c             gt = '\n'.join(gt[i:i+2*pop.totNumLoci()] for i in range(len(gt)) %0a%3c                 if i %25 (2*pop.totNumLoci()) == 0)%0a%3c             print >> datOut, gt%0a%3c             print >> datOut, '\n'%0a%3c     elif pop.ploidy() == 2:%0a%3c         for sp in range(0, pop.numSubPop()):%0a%3c             for ind in pop.individuals(sp):%0a%3c                 gt = ''%0a%3c                 for loc in range(pop.totNumLoci()):%0a%3c                     if pop.alleleNames() == ():%0a%3c                         gt += '%25d%25d' %25 (ind.allele(loc, 0) + pad, ind.allele(loc, 1) + pad)%0a%3c                     else:%0a%3c                         gt += pop.alleleName(ind.allele(loc, 0)) + pop.alleleName(ind.allele(loc, 1))%0a%3c                     gt += ' '%0a%3c                 print >> datOut, gt%0a%3c             print >> datOut, '\n'%0a%3c     else:%0a%3c         raise exceptions.ValueError, "POPGENE only supports haploid and diploid."%0a%3c     datOut.close()%0a%3c %0a%3c =]%0a\ No newline at end of file%0a
host:1238103697=127.0.0.1
